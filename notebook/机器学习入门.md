# 机器学习入门

###### 基本概念

1. 有监督学习：对具有概念标记（分类）的训练样本进行学习，对训练样本集外的数据进行标记（分类）预测。这里，所有的标记（分类）是已知。因此，训练样本的歧义性低。
2. 无监督学习：对没有概念标记（分类）的训练样本进行学习，以便发现训练样本集中的结构性知识。标记是未知的。歧义性比较高。聚类就是典型的无监督学习。
3. 准确率与召回率：信息检索、分类、识别、翻译等领域中的两个基本指标：召回率和准确率，召回率也叫全查率，准确率也叫查准率。

二分问题有四种情况：真正、假正（误报）、真负、假负（漏报）。

召回率 =  TP/(TP+FN)

准确率 = TP/(TP+FP)

###### 数据集

1. KDD99数据

   Knowledge Discovery and Data Mining的简称

   网络连接定义为：在某个时间内从开始到结束的TCP数据包序列，并且在这段时间内，数据在预定义的协议从源IP地址到目的IP地址传递。每个网络连接标记为正常（normal）或异常（attack），异常类型呗细分为4大类共39种攻击类型，其中22种攻击类型出现在训练集中，另有17种未知攻击类型出现在测试集中。

   TCP连接基本特征

   TCP连接的内容特征

   基于时间的网络流量统计特征

   基于主机的网络流量统计特征

   数据样例：

   ```
   2, tcp, smtp, SF, 1684, 363, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 104, 66, 0.63, 0.03, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, normal.
   
   
   0, tcp, private, REJ, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38, 1, 0.00, 0.00, 1.00, 1.00, 0.03, 0.55, 0.00, 208, 1, 0.00, 0.11, 0.18, 0.00, 0.01, 0.00, 0.42, 1.00, portsweep.
   
   
   0, tcp, smtp, SF, 787, 329, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 76, 117, 0.49, 0.08, 0.01, 0.02, 0.00, 0.00, 0.00, 0.00, normal.
   ```

   参考文献：入侵检测数据集KDD CUP99研究 张有新，贾磊。


###### 特征提取

1. 数字型特征提取

   数字特征可以直接作为特征，但是对于一个多维的特征，某一个特征的取值范围特别大，很可能但是其他特征对结果的影响被忽略，这时候我们需要对数字型特征进行预处理，常见的预处理方式有一下几种。

   1. 标准化

      ```
      In[2]: from sklearn import preprocessing
      In[3]: import numpy as np
      In[4]: X = np.array([[1., -1., 2.],])
      In[5]: X = np.array([[1., -1., 2.],[2., 0., 0],[0., 1., -1]])
      In[6]: X_scaled = preprocessing.scale(X)
      In[7]: help(sklean.preprocessing)
      In[12]: X_scaled
      Out[12]: 
      array([[ 0.        , -1.22474487,  1.33630621],
             [ 1.22474487,  0.        , -0.26726124],
             [-1.22474487,  1.22474487, -1.06904497]])
      In[13]: X = np.array([[1., -1., 2.],[2., 0., 0],[0., 1., -1]])
      ```

   2. 正则化

      ```python
      Out[16]: 
      array([[ 1., -1.,  2.],
             [ 2.,  0.,  0.],
             [ 0.,  1., -1.]])
      In[18]: X_normalized = preprocessing.normalize(X, norm='l2')
      In[19]: X_normalized
      Out[19]: 
      array([[ 0.40824829, -0.40824829,  0.81649658],
             [ 1.        ,  0.        ,  0.        ],
             [ 0.        ,  0.70710678, -0.70710678]])
      ```

   3. 归一化

      ```python
      In[20]: X_train = np.array([[ 1., -1.,  2.],
         ...:                     [ 2.,  0.,  0.],
         ...:                     [ 0.,  1., -1.]])
      In[21]: min_max_scaler = preprocessing.MinMaxScaler()
      In[22]: X_train_minmax = min_max_scaler.fit_transform(X_train)
      In[23]: X_train_minmax
      Out[23]: 
      array([[0.5       , 0.        , 1.        ],
             [1.        , 0.5       , 0.33333333],
             [0.        , 1.        , 0.        ]])
      ```

2. 文本型特征提取

   pass

###### 数据读取

平时处理数据时，csv是最常见的格式，文件的每行记录一个向量，其中最后一列为标记。TensorFlow提供了非常便捷的方式从csv文件中读取数据集。

###### 效果验证

pass
